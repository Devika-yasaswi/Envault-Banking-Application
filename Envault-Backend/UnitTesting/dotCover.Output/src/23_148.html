<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\ENVAULT\Envault-Backend\Envault-Backend\Controllers\LoginAndRegistrationController.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using ApplicationLayer.Interfaces;
using BusinessLogicLayer;
using CoreModels.Entities;
using CoreModels;
using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Mvc;

namespace Envault_Backend.Controllers
{
    [Route(&quot;api/[controller]&quot;)]
    [ApiController]
    public class LoginAndRegistrationController : ControllerBase
    {
        private readonly LoginAndRegistrationService _loginAndRegistrationService;
        private readonly IConfiguration _configuration;
        private readonly TokenService _tokenService;
        private readonly ILogger&lt;LoginAndRegistrationController&gt; _logger;
        public LoginAndRegistrationController(IUnitOfWork unitOfWork, IConfiguration configuration, ILogger&lt;LoginAndRegistrationController&gt; logger)
        {
            _loginAndRegistrationService = new LoginAndRegistrationService(unitOfWork);
            _configuration = configuration;
            _tokenService = new TokenService(configuration);
            _logger = logger;
        }
        [HttpPost]
        [Route(&quot;CheckUserExistence&quot;)]
        public async Task&lt;GenericResponse&gt; CheckUserExistence(long customerId)
        {
            try
            {
                bool result = await Task.FromResult(_loginAndRegistrationService.CheckUserExistence(customerId));
                if (result)
                    return new GenericResponse { Status = true, Data = result };
                return new GenericResponse { Status = true, Data = _configuration[&quot;GenericMessages:Values:customerNotExist&quot;] };
            }
            catch (Exception ex)
            {
                _logger.LogError(ex.Message);
                return new GenericResponse { Status = false, Error = new Error() { Description = &quot;&quot; } };
            }
        }
        [HttpPost]
        [Route(&quot;IsRegisteredCustomer&quot;)]
        public async Task&lt;GenericResponse&gt; IsRegisteredCustomer(long customerId)
        {
            try
            {
                bool result = await Task.FromResult(_loginAndRegistrationService.IsRegisteredCustomer(customerId));
                if (result)
                    return new GenericResponse { Status = true, Data = _configuration[&quot;GenericMessages:Values:duplicateRegistration&quot;] };
                return new GenericResponse { Status = true, Data = result};
            }
            catch (Exception ex)
            {
                _logger.LogError(ex.Message);
                return new GenericResponse { Status = false, Error = new Error() { Description = &quot;&quot; } };
            }
        }
        [HttpPost]
        [Route(&quot;RegisterNewUser&quot;)]
        public async Task&lt;GenericResponse&gt; RegisterNewUser(LoginCredentialsEntity loginCredentials)
        {
            try
            {
                bool result = await Task.FromResult(_loginAndRegistrationService.RegisterNewUser(loginCredentials));
                if (result)
                    return new GenericResponse { Status = true, Data = _configuration[&quot;GenericMessages:Values:registrationSuccess&quot;] };
                return new GenericResponse { Status = true, Data = result };
            }
            catch (Exception ex)
            {
                _logger.LogError(ex.Message);
                return new GenericResponse { Status = false, Error = new Error() { Description = &quot;&quot; } };
            }
        }
        [HttpPost]
        [Route(&quot;GetUserSecurityMessage&quot;)]
        public async Task&lt;GenericResponse&gt; GetUserSecurityMessage(long customerId)
        {
            try
            {
                string securityMessage = await Task.FromResult(_loginAndRegistrationService.GetUserSecurityMessage(customerId));
                return new GenericResponse { Status = true, Data = securityMessage };
            }
            catch (Exception ex)
            {
                _logger.LogError(ex.Message);
                return new GenericResponse { Status = false, Error = new Error() { Description = &quot;&quot; } };
            }
        }
        [HttpPost]
        [Route(&quot;ValidateUserToLogin&quot;)]
        public async Task&lt;GenericResponse&gt; ValidateUserToLogin(long customerId, string password)
        {
            try
            {
                bool result = await Task.FromResult(_loginAndRegistrationService.ValidateUserToLogin(customerId, password));
                if (result)
                {
                    string token = _tokenService.GetToken(customerId.ToString(), true);
                    return new GenericResponse { Status = true, Data = token };
                }
                return new GenericResponse { Status = true, Data = result };
            }
            catch (Exception ex)
            {
                _logger.LogError(ex.Message);
                return new GenericResponse { Status = false, Error = new Error() { Description = &quot;&quot; } };
            }
        }
        [HttpPost]
        [Route(&quot;CheckUserExistenceWithAadhar&quot;)]
        public async Task&lt;GenericResponse&gt; CheckUserExistenceWithAadhar(long aadharNumber)
        {
            try
            {
                bool result = await Task.FromResult(_loginAndRegistrationService.CheckUserExistenceWithAadhar(aadharNumber));
                if (result)
                    return new GenericResponse { Status = true, Data = result };
                return new GenericResponse { Status = true, Data = _configuration[&quot;GenericMessages:Values:customerNotExist&quot;] };
            }
            catch (Exception ex)
            {
                _logger.LogError(ex.Message);
                return new GenericResponse { Status = false, Error = new Error() { Description = &quot;&quot; } };
            }
        }
        [HttpGet]
        [Route(&quot;GetCustomerId&quot;)]
        public async Task&lt;GenericResponse&gt; GetCustomerId(long aadharNumber)
        {
            try
            {
                long customerId = await Task.FromResult(_loginAndRegistrationService.GetCustomerId(aadharNumber));
                return new GenericResponse { Status = true, Data = customerId };
            }
            catch (Exception ex)
            {
                _logger.LogError(ex.Message);
                return new GenericResponse { Status = false, Error = new Error() { Description = &quot;&quot; } };
            }
        }
        [HttpPost]
        [Route(&quot;ResetPassword&quot;)]
        public async Task&lt;GenericResponse&gt; ResetPassword(long customerId, string password)
        {
            try
            {
                bool result = await Task.FromResult(_loginAndRegistrationService.ResetPassword(customerId, password));
                return new GenericResponse { Status = true, Data = _configuration[&quot;GenericMessages:Values:passwordResetSuccess&quot;] };
            }
            catch (Exception ex)
            {
                _logger.LogError(ex.Message);
                return new GenericResponse { Status = false, Error = new Error() { Description = &quot;&quot; } };
            }
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[18,9,18,148,1],[19,9,19,10,1],[20,13,20,88,1],[21,13,21,44,1],[22,13,22,61,1],[23,13,23,30,1],[24,9,24,10,1],[28,9,28,10,1],[30,13,30,14,1],[31,17,31,114,1],[32,17,32,28,1],[33,21,33,81,1],[34,17,34,128,1],[36,13,36,33,1],[37,13,37,14,1],[38,17,38,46,1],[39,17,39,105,1],[41,9,41,10,1],[45,9,45,10,1],[47,13,47,14,1],[48,17,48,116,1],[49,17,49,28,1],[50,21,50,137,1],[51,17,51,76,1],[53,13,53,33,1],[54,13,54,14,1],[55,17,55,46,1],[56,17,56,105,1],[58,9,58,10,1],[62,9,62,10,1],[64,13,64,14,1],[65,17,65,117,1],[66,17,66,28,1],[67,21,67,135,1],[68,17,68,77,1],[70,13,70,33,1],[71,13,71,14,1],[72,17,72,46,1],[73,17,73,105,1],[75,9,75,10,1],[79,9,79,10,1],[81,13,81,14,1],[82,17,82,129,1],[83,17,83,86,1],[85,13,85,33,1],[86,13,86,14,1],[87,17,87,46,1],[88,17,88,105,1],[90,9,90,10,1],[94,9,94,10,1],[96,13,96,14,1],[97,17,97,125,1],[98,17,98,28,1],[99,17,99,18,1],[100,21,100,88,1],[101,21,101,80,1],[103,17,103,77,1],[105,13,105,33,1],[106,13,106,14,1],[107,17,107,46,1],[108,17,108,105,1],[110,9,110,10,1],[114,9,114,10,1],[116,13,116,14,1],[117,17,117,126,1],[118,17,118,28,1],[119,21,119,81,1],[120,17,120,128,1],[122,13,122,33,1],[123,13,123,14,1],[124,17,124,46,1],[125,17,125,105,1],[127,9,127,10,1],[131,9,131,10,1],[133,13,133,14,1],[134,17,134,115,1],[135,17,135,81,1],[137,13,137,33,1],[138,13,138,14,1],[139,17,139,46,1],[140,17,140,105,1],[142,9,142,10,1],[146,9,146,10,1],[148,13,148,14,1],[149,17,149,119,1],[150,17,150,132,1],[152,13,152,33,1],[153,13,153,14,1],[154,17,154,46,1],[155,17,155,105,1],[157,9,157,10,1]]);
    </script>
  </body>
</html>